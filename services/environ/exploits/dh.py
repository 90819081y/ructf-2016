# First stupid version of DH crack by bruteforce shared secret
import sys
a = int(sys.argv[1])
g = int(sys.argv[2])
p = int(sys.argv[3])
for i in range(0, p):
    secret = g ** i % p
    b = a // secret
    try:
        c = int(b).to_bytes(300, byteorder='big').lstrip(b'\0')
        if b'put:' in c:
            print(c)
            break
    except:
        pass
